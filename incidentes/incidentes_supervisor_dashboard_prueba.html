<div id="incidentes-supervisor-dashboard" class="civix-view">
    <style>
        /* Scoped styles for supervisor dashboard */
        #incidentes-supervisor-dashboard {
            font-family: system-ui, -apple-system, sans-serif;
            padding: 20px;
        }

        #incidentes-supervisor-dashboard .dashboard-header {
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid #2a2a2a;
        }

        #incidentes-supervisor-dashboard .dashboard-title {
            font-size: 1.8rem;
            color: #FFFFFF;
            margin: 0 0 5px 0;
        }

        #incidentes-supervisor-dashboard .dashboard-subtitle {
            font-size: 0.9rem;
            color: #a6adbb;
            margin: 0;
        }

        /* Secci√≥n de operadores */
        #incidentes-supervisor-dashboard .section {
            margin-bottom: 30px;
        }

        #incidentes-supervisor-dashboard .section-title {
            font-size: 1.3rem;
            color: #FFFFFF;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #incidentes-supervisor-dashboard .section-title .badge {
            background: #f67200;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 600;
        }

        /* Grid vertical de operadores en columna */
        #incidentes-supervisor-dashboard .operators-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-height: calc(100vh - 300px);
            overflow-y: auto;
            padding: 5px;
            scrollbar-width: thin;
            scrollbar-color: #666 #222;
        }

        #incidentes-supervisor-dashboard .operators-list::-webkit-scrollbar {
            width: 6px;
        }

        #incidentes-supervisor-dashboard .operators-list::-webkit-scrollbar-track {
            background: #222;
        }

        #incidentes-supervisor-dashboard .operators-list::-webkit-scrollbar-thumb {
            background: #666;
            border-radius: 3px;
        }

        #incidentes-supervisor-dashboard .operator-item {
            background: #1a1a1a;
            border: 2px solid #2a2a2a;
            border-radius: 8px;
            padding: 10px 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        #incidentes-supervisor-dashboard .operator-item:hover {
            background: #252525;
            border-color: #3a3a3a;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        #incidentes-supervisor-dashboard .operator-item.ending-shift {
            border-color: #ffc107;
            background: rgba(255, 193, 7, 0.05);
        }

        #incidentes-supervisor-dashboard .operator-item.ending-shift::before {
            content: '‚ö†Ô∏è';
            position: absolute;
            top: 8px;
            right: 8px;
            font-size: 1.2rem;
        }

        #incidentes-supervisor-dashboard .operator-icon {
            width: 40px;
            height: 40px;
            background: #2a2a2a;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            position: relative;
            flex-shrink: 0;
        }

        #incidentes-supervisor-dashboard .operator-info {
            flex: 1;
            min-width: 0;
        }

        #incidentes-supervisor-dashboard .operator-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: #FFFFFF;
            margin-bottom: 3px;
            line-height: 1.2;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        #incidentes-supervisor-dashboard .operator-meta {
            font-size: 1rem;
            color: #a6adbb;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        #incidentes-supervisor-dashboard .ticket-count {
            background: #f67200;
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 4px;
            flex-shrink: 0;
        }

        #incidentes-supervisor-dashboard .ticket-count i {
            font-size: 0.75rem;
        }

        #incidentes-supervisor-dashboard .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }

        #incidentes-supervisor-dashboard .status-dot.active {
            background: #22c55e;
            box-shadow: 0 0 8px rgba(34, 197, 94, 0.6);
        }

        #incidentes-supervisor-dashboard .status-dot.ending {
            background: #ffc107;
            box-shadow: 0 0 8px rgba(255, 193, 7, 0.6);
            animation: pulse-dot 2s ease-in-out infinite;
        }

        @keyframes pulse-dot {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Lista de tickets */
        #incidentes-supervisor-dashboard .tickets-container {
            background: #1a1a1a;
            border: 2px solid #2a2a2a;
            border-radius: 12px;
            padding: 15px;
            max-height: calc(100vh - 400px);
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #666 #222;
        }

        #incidentes-supervisor-dashboard .tickets-container::-webkit-scrollbar {
            width: 6px;
        }

        #incidentes-supervisor-dashboard .tickets-container::-webkit-scrollbar-track {
            background: #222;
        }

        #incidentes-supervisor-dashboard .tickets-container::-webkit-scrollbar-thumb {
            background: #666;
            border-radius: 3px;
        }

        #incidentes-supervisor-dashboard .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #a6adbb;
        }

        #incidentes-supervisor-dashboard .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        #incidentes-supervisor-dashboard .empty-state p {
            font-size: 1.1.2rem;
            margin: 0;
        }

        #incidentes-supervisor-dashboard .tickets-list {
            display: grid;
            gap: 12px;
        }

        #incidentes-supervisor-dashboard .ticket-card {
            background: #252525;
            border: 2px solid #2a2a2a;
            border-left: 4px solid #f67200;
            border-radius: 8px;
            padding: 16px;
            transition: all 0.3s ease;
        }

        #incidentes-supervisor-dashboard .ticket-card:hover {
            background: #2a2a2a;
            transform: translateX(4px);
        }

        #incidentes-supervisor-dashboard .ticket-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        #incidentes-supervisor-dashboard .ticket-id {
            font-size: 1.2rem;
            font-weight: 600;
            color: #FFFFFF;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        #incidentes-supervisor-dashboard .priority-circle {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }

        #incidentes-supervisor-dashboard .priority-critica {
            background: #dc3545;
            box-shadow: 0 0 8px rgba(220, 53, 69, 0.6);
        }

        #incidentes-supervisor-dashboard .priority-alta {
            background: #ff7a2f;
            box-shadow: 0 0 8px rgba(255, 122, 47, 0.6);
        }

        #incidentes-supervisor-dashboard .priority-media {
            background: #ffc107;
            box-shadow: 0 0 8px rgba(255, 193, 7, 0.6);
        }

        #incidentes-supervisor-dashboard .priority-baja {
            background: #28a745;
            box-shadow: 0 0 8px rgba(40, 167, 69, 0.6);
        }

        #incidentes-supervisor-dashboard .ticket-status {
            font-size: 0.75rem;
            padding: 4px 10px;
            border-radius: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        #incidentes-supervisor-dashboard .ticket-status.abierto {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
            border: 1px solid #3b82f6;
        }

        #incidentes-supervisor-dashboard .ticket-status.asignado {
            background: rgba(139, 92, 246, 0.2);
            color: #8b5cf6;
            border: 1px solid #8b5cf6;
        }

        #incidentes-supervisor-dashboard .ticket-status.en-atencion {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
            border: 1px solid #ffc107;
        }

        #incidentes-supervisor-dashboard .ticket-body {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 15px;
            margin-top: 12px;
        }

        #incidentes-supervisor-dashboard .ticket-info {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        #incidentes-supervisor-dashboard .info-row {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.2rem;
            color: #a6adbb;
        }

        #incidentes-supervisor-dashboard .info-row i {
            color: #f67200;
            width: 16px;
        }

        #incidentes-supervisor-dashboard .info-row strong {
            color: #FFFFFF;
        }

        #incidentes-supervisor-dashboard .ticket-time {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #1a1a1a;
            border-radius: 8px;
            padding: 10px;
        }

        #incidentes-supervisor-dashboard .time-label {
            font-size: 1rem;
            color: #a6adbb;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        #incidentes-supervisor-dashboard .time-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: #f67200;
        }

        /* Buscador de operadores */
        #incidentes-supervisor-dashboard .search-box {
            margin-bottom: 15px;
            position: relative;
        }

        #incidentes-supervisor-dashboard .search-input {
            width: 100%;
            padding: 12px 40px 12px 15px;
            background: #1a1a1a;
            border: 2px solid #2a2a2a;
            border-radius: 8px;
            color: #FFFFFF;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        #incidentes-supervisor-dashboard .search-input:focus {
            outline: none;
            border-color: #f67200;
            box-shadow: 0 0 0 3px rgba(246, 114, 0, 0.1);
        }

        #incidentes-supervisor-dashboard .search-input::placeholder {
            color: #6b7280;
        }

        #incidentes-supervisor-dashboard .search-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #6b7280;
            pointer-events: none;
        }

        /* Checkbox circular para selecci√≥n de tickets */
        .ticket-checkbox {
            appearance: none;
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid #666;
            border-radius: 50%;
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
        }

        .ticket-checkbox:checked {
            border-color: #f67200;
            background: #f67200;
        }

        .ticket-checkbox:checked::after {
            content: '‚úì';
            position: absolute;
            color: white;
            font-size: 12px;
            font-weight: bold;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .ticket-card.selected {
            border-left-color: #f67200;
            background: rgba(246, 114, 0, 0.05);
        }

        /* Responsive */
        @media (max-width: 768px) {
            #incidentes-supervisor-dashboard .operators-grid {
                grid-template-columns: 1fr;
            }

            #incidentes-supervisor-dashboard .ticket-body {
                grid-template-columns: 1fr;
            }
        }
    </style>

    <!-- Layout de 2 columnas -->
    <div style="display: grid; grid-template-columns: 30% 70%; gap: 20px; height: calc(100vh - 200px);">

        <!-- COLUMNA IZQUIERDA: Operadores -->
        <div class="section" style="margin-bottom: 0;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h2 class="section-title" style="margin-bottom: 0;">
                    <i class="pe-7s-users" aria-hidden="true"></i>
                    Operadores en Turno
                    <span class="badge" id="operatorsCount">0</span>
                </h2>
                <div class="search-box" style="margin-bottom: 0; max-width: 250px;">
                    <input
                        type="text"
                        id="operatorSearch"
                        class="search-input"
                        placeholder="Buscar operador..."
                    />
                    <i class="pe-7s-search search-icon" aria-hidden="true"></i>
                </div>
            </div>
            <!-- Filtros de operadores -->
            <div style="display: flex; gap: 8px; margin-bottom: 12px; border-bottom: 2px solid #2a2a2a; padding-bottom: 8px;">
                <button
                    class="operator-filter-tab active"
                    data-filter="all"
                    style="background: none; border: none; color: #FFFFFF; font-size: 1.2rem; padding: 6px 12px; cursor: pointer; border-bottom: 2px solid #f67200; transition: all 0.3s;"
                >
                    Todos <span class="badge" style="background: #555; font-size: 1rem; padding: 2px 6px;" id="allOperatorsCount">0</span>
                </button>
                <button
                    class="operator-filter-tab"
                    data-filter="active"
                    style="background: none; border: none; color: #a6adbb; font-size: 1.2rem; padding: 6px 12px; cursor: pointer; border-bottom: 2px solid transparent; transition: all 0.3s;"
                >
                    Activos <span class="badge" style="background: #555; font-size: 1rem; padding: 2px 6px;" id="activeOperatorsCount">0</span>
                </button>
                <button
                    class="operator-filter-tab"
                    data-filter="ending"
                    style="background: none; border: none; color: #a6adbb; font-size: 1.2rem; padding: 6px 12px; cursor: pointer; border-bottom: 2px solid transparent; transition: all 0.3s;"
                >
                    Terminando <span class="badge" style="background: #555; font-size: 1rem; padding: 2px 6px;" id="endingOperatorsCount">0</span>
                </button>
            </div>

            <div class="operators-list" id="operatorsList">
                <!-- Los operadores se renderizan aqu√≠ con JS -->
            </div>
        </div>

        <!-- COLUMNA DERECHA: Tickets -->
        <div class="section" style="margin-bottom: 0;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <h2 class="section-title" style="margin-bottom: 0;">
                <i class="pe-7s-note2" aria-hidden="true"></i>
                Gesti√≥n de Tickets
            </h2>
            <button
                id="reassignSelectedBtn"
                class="btn btn-accent"
                style="display: none;"
                onclick="window.supervisorDashboard.openReassignModal()"
            >
                <i class="pe-7s-repeat" aria-hidden="true"></i> Reasignar Seleccionados (<span id="selectedTicketsCount">0</span>)
            </button>
        </div>

        <!-- Tabs de Tickets (din√°micos) -->
        <div id="ticketTabsContainer" style="display: flex; gap: 10px; margin-bottom: 15px; border-bottom: 2px solid #2a2a2a; padding-bottom: 5px; overflow-x: auto; white-space: nowrap;">
            <button
                class="ticket-filter-tab active"
                data-filter="all"
                data-operator=""
                style="background: none; border: none; color: #FFFFFF; font-size: 1.2rem; padding: 8px 16px; cursor: pointer; border-bottom: 3px solid #f67200; transition: all 0.3s;"
            >
                Todos <small><span class="badge" id="allTicketsCount">0</span></small>
            </button>
            <button
                class="ticket-filter-tab"
                data-filter="reassigned"
                data-operator=""
                style="background: none; border: none; color: #a6adbb; font-size: 1.2rem; padding: 8px 16px; cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.3s;"
            >
                Reasignados <small><span class="badge" id="reassignedTicketsCount">0</span></small>
            </button>
            <button
                class="ticket-filter-tab"
                data-filter="not-reassigned"
                data-operator=""
                style="background: none; border: none; color: #a6adbb; font-size: 1.2rem; padding: 8px 16px; cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.3s;"
            >
                No Reasignados <small><span class="badge" id="notReassignedTicketsCount">0</span></small>
            </button>
            <!-- Los tabs de operadores se agregar√°n aqu√≠ din√°micamente -->
        </div>

        <!-- Buscador de tickets -->
        <div class="search-box" style="margin-bottom: 15px;">
            <input
                type="text"
                id="ticketSearch"
                class="search-input"
                placeholder="Buscar ticket por ID, tipo o agente..."
            />
            <i class="pe-7s-search search-icon" aria-hidden="true"></i>
        </div>

        <div class="tickets-container" id="ticketsContainer">
            <div class="empty-state">
                <i class="pe-7s-note2" aria-hidden="true"></i>
                <p>No hay tickets activos</p>
            </div>
        </div>

        </div>
    </div>

    <!-- Modal de Reasignaci√≥n (Bootstrap) -->
    <div class="modal fade" id="reassignModal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header text-left">
                    <h4 class="modal-title mb-0">Reasignar Tickets</h4>
                    <h7 class="mb-0" id="reassignModalSubtitle">Seleccione el operador destino</h7>
                </div>
                <div class="modal-body">
                    <div id="reassignModalBody">
                        <!-- El contenido se renderiza din√°micamente -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default btn-rounded" data-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-accent btn-rounded" id="confirmReassignBtn" disabled onclick="window.supervisorDashboard.confirmReassignment()">
                        Confirmar Reasignaci√≥n
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
    (function() {
        // Datos de ejemplo (estos vendr√≠an del backend en tiempo real)
        let operatorsData = [
            {
                id: 'op1',
                name: 'Juan P√©rez',
                status: 'active',
                ticketsCount: 3,
                endingShift: false,
                tickets: [
                    {
                        id: 'INC-2025-001',
                        name: 'Robo de Veh√≠culo',
                        priority: 'critica',
                        status: 'en-atencion',
                        startTime: new Date(Date.now() - 45 * 60000), // 45 min ago
                        assignedAgent: 'Agente Ram√≠rez'
                    },
                    {
                        id: 'INC-2025-005',
                        name: 'Persona Sospechosa',
                        priority: 'media',
                        status: 'asignado',
                        startTime: new Date(Date.now() - 20 * 60000), // 20 min ago
                        assignedAgent: 'Agente Torres'
                    },
                    {
                        id: 'INC-2025-008',
                        name: 'Veh√≠culo Sospechoso',
                        priority: 'alta',
                        status: 'abierto',
                        startTime: new Date(Date.now() - 10 * 60000), // 10 min ago
                        assignedAgent: null
                    },
                    {
                        id: 'INC-2025-011',
                        name: 'Persona Desaparecida',
                        priority: 'alta',
                        status: 'cerrado',
                        startTime: new Date(Date.now() - 120 * 60000), // 2 hours ago
                        assignedAgent: 'Agente Ram√≠rez'
                    }
                ]
            },
            {
                id: 'op2',
                name: 'Mar√≠a Gonz√°lez',
                status: 'active',
                ticketsCount: 2,
                endingShift: true,
                tickets: [
                    {
                        id: 'INC-2025-003',
                        name: 'Persona Desaparecida',
                        priority: 'alta',
                        status: 'en-atencion',
                        startTime: new Date(Date.now() - 90 * 60000), // 1.5 hours ago
                        assignedAgent: 'Agente Vega'
                    },
                    {
                        id: 'INC-2025-007',
                        name: 'Robo de Veh√≠culo',
                        priority: 'critica',
                        status: 'asignado',
                        startTime: new Date(Date.now() - 5 * 60000), // 5 min ago
                        assignedAgent: 'Agente L√≥pez'
                    }
                ]
            },
            {
                id: 'op3',
                name: 'Carlos Ruiz',
                status: 'active',
                ticketsCount: 5,
                endingShift: false,
                tickets: [
                    {
                        id: 'INC-2025-002',
                        name: 'Persona Requisitoriada',
                        priority: 'alta',
                        status: 'en-atencion',
                        startTime: new Date(Date.now() - 120 * 60000), // 2 hours ago
                        assignedAgent: 'Agente Garc√≠a'
                    },
                    {
                        id: 'INC-2025-004',
                        name: 'Otra Incidencia',
                        priority: 'baja',
                        status: 'abierto',
                        startTime: new Date(Date.now() - 15 * 60000),
                        assignedAgent: null
                    },
                    {
                        id: 'INC-2025-006',
                        name: 'Veh√≠culo Sospechoso',
                        priority: 'media',
                        status: 'asignado',
                        startTime: new Date(Date.now() - 30 * 60000),
                        assignedAgent: 'Agente Mart√≠nez'
                    },
                    {
                        id: 'INC-2025-009',
                        name: 'Robo de Veh√≠culo',
                        priority: 'critica',
                        status: 'en-atencion',
                        startTime: new Date(Date.now() - 60 * 60000),
                        assignedAgent: 'Agente Fern√°ndez'
                    },
                    {
                        id: 'INC-2025-010',
                        name: 'Persona Sospechosa',
                        priority: 'alta',
                        status: 'abierto',
                        startTime: new Date(Date.now() - 8 * 60000),
                        assignedAgent: null
                    }
                ]
            },
            {
                id: 'op4',
                name: 'Ana L√≥pez',
                status: 'active',
                ticketsCount: 1,
                endingShift: false,
                tickets: []
            },
            {
                id: 'op5',
                name: 'Pedro Mart√≠nez',
                status: 'active',
                ticketsCount: 4,
                endingShift: false,
                tickets: []
            },
            {
                id: 'op6',
                name: 'Laura Torres',
                status: 'active',
                ticketsCount: 2,
                endingShift: true,
                tickets: []
            },
            {
                id: 'op7',
                name: 'Diego Ram√≠rez',
                status: 'active',
                ticketsCount: 3,
                endingShift: false,
                tickets: []
            },
            {
                id: 'op8',
                name: 'Carmen Silva',
                status: 'active',
                ticketsCount: 0,
                endingShift: false,
                tickets: []
            },
            {
                id: 'op9',
                name: 'Roberto Vega',
                status: 'active',
                ticketsCount: 6,
                endingShift: false,
                tickets: []
            },
            {
                id: 'op10',
                name: 'Isabel Castro',
                status: 'active',
                ticketsCount: 2,
                endingShift: true,
                tickets: []
            },
            {
                id: 'op11',
                name: 'Miguel Flores',
                status: 'active',
                ticketsCount: 3,
                endingShift: false,
                tickets: []
            },
            {
                id: 'op12',
                name: 'Patricia Rojas',
                status: 'active',
                ticketsCount: 1,
                endingShift: false,
                tickets: []
            },
            {
                id: 'op13',
                name: 'Fernando D√≠az',
                status: 'active',
                ticketsCount: 5,
                endingShift: false,
                tickets: []
            },
            {
                id: 'op14',
                name: 'Sof√≠a Mendoza',
                status: 'active',
                ticketsCount: 2,
                endingShift: false,
                tickets: []
            },
            {
                id: 'op15',
                name: 'Andr√©s Herrera',
                status: 'active',
                ticketsCount: 4,
                endingShift: true,
                tickets: []
            },
            {
                id: 'op16',
                name: 'Valentina Ortiz',
                status: 'active',
                ticketsCount: 3,
                endingShift: false,
                tickets: []
            },
            {
                id: 'op17',
                name: 'Ricardo N√∫√±ez',
                status: 'active',
                ticketsCount: 2,
                endingShift: false,
                tickets: []
            },
            {
                id: 'op18',
                name: 'Elena Vargas',
                status: 'active',
                ticketsCount: 1,
                endingShift: true,
                tickets: []
            },
            {
                id: 'op19',
                name: 'Javier Morales',
                status: 'active',
                ticketsCount: 5,
                endingShift: false,
                tickets: []
            },
            {
                id: 'op20',
                name: 'Luc√≠a Reyes',
                status: 'active',
                ticketsCount: 3,
                endingShift: false,
                tickets: []
            }
        ];

        // Generar 50 tickets distribuidos entre operadores
        (function generateTickets() {
            const ticketTypes = ['Robo de Veh√≠culo', 'Persona Sospechosa', 'Persona Desaparecida', 'Veh√≠culo Sospechoso', 'Otra Incidencia', 'Accidente de Tr√°nsito', 'Disturbios', 'Incendio'];
            const priorities = ['critica', 'alta', 'media', 'baja'];
            const statuses = ['abierto', 'asignado', 'en-atencion'];
            const agents = ['Agente Ram√≠rez', 'Agente Vega', 'Agente Torres', 'Agente L√≥pez', 'Agente Garc√≠a', 'Agente Mart√≠nez', 'Agente Fern√°ndez', 'Agente Castro', 'Agente Silva', null];

            let ticketCounter = 1;

            operatorsData.forEach(function(operator) {
                const numTickets = operator.ticketsCount;
                operator.tickets = [];

                for (let i = 0; i < numTickets; i++) {
                    const ticketId = 'INC-2025-' + String(ticketCounter).padStart(3, '0');
                    const randomMinutes = Math.floor(Math.random() * 180); // Random 0-180 minutos

                    operator.tickets.push({
                        id: ticketId,
                        name: ticketTypes[Math.floor(Math.random() * ticketTypes.length)],
                        priority: priorities[Math.floor(Math.random() * priorities.length)],
                        status: statuses[Math.floor(Math.random() * statuses.length)],
                        startTime: new Date(Date.now() - randomMinutes * 60000),
                        assignedAgent: agents[Math.floor(Math.random() * agents.length)]
                    });

                    ticketCounter++;
                }
            });
        })();

        let operatorSearchTerm = '';
        let operatorFilter = 'all'; // Filtro de operadores: 'all', 'active', 'ending'
        let selectedTickets = []; // Array de IDs de tickets seleccionados
        let selectedOperatorForReassign = null;
        let reassignmentHistory = []; // Historial de reasignaciones del d√≠a
        let ticketFilter = 'all'; // Filtro de tickets: 'all', 'reassigned', 'not-reassigned'
        let activeOperatorTab = null; // ID del operador del tab activo (null = vista general)
        let openOperatorTabs = []; // Array de IDs de operadores con tabs abiertos
        let ticketSearchTerm = ''; // T√©rmino de b√∫squeda de tickets

        // Funci√≥n para calcular tiempo transcurrido
        function getElapsedTime(startTime) {
            const now = new Date();
            const diff = now - startTime;
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(minutes / 60);
            const mins = minutes % 60;

            if (hours > 0) {
                return hours + 'h ' + mins + 'm';
            }
            return mins + 'm';
        }

        // Funci√≥n para renderizar operadores
        function renderOperators() {
            const list = document.getElementById('operatorsList');
            const countBadge = document.getElementById('operatorsCount');

            if (!list) return;

            // Filtrar operadores por b√∫squeda y filtro de estado
            let filteredOperators = operatorsData.filter(function(operator) {
                // Filtro de b√∫squeda
                const matchesSearch = operatorSearchTerm.trim() === '' ||
                    operator.name.toLowerCase().includes(operatorSearchTerm.toLowerCase());

                // Filtro de estado
                let matchesFilter = true;
                if (operatorFilter === 'active') {
                    matchesFilter = !operator.endingShift;
                } else if (operatorFilter === 'ending') {
                    matchesFilter = operator.endingShift;
                }

                return matchesSearch && matchesFilter;
            });

            // Actualizar contadores
            const allCount = operatorsData.length;
            const activeCount = operatorsData.filter(op => !op.endingShift).length;
            const endingCount = operatorsData.filter(op => op.endingShift).length;

            document.getElementById('allOperatorsCount').textContent = allCount;
            document.getElementById('activeOperatorsCount').textContent = activeCount;
            document.getElementById('endingOperatorsCount').textContent = endingCount;

            list.innerHTML = '';
            countBadge.textContent = filteredOperators.length;

            if (filteredOperators.length === 0) {
                list.innerHTML = '<div class="empty-state"><i class="pe-7s-search" aria-hidden="true"></i><p>No se encontraron operadores</p></div>';
                return;
            }

            filteredOperators.forEach(function(operator) {
                const item = document.createElement('div');
                item.className = 'operator-item';

                if (operator.endingShift) {
                    item.classList.add('ending-shift');
                }

                const statusDotClass = operator.endingShift ? 'ending' : 'active';
                const statusText = operator.endingShift ? 'Turno terminando' : 'Activo';

                item.innerHTML =
                    '<div class="operator-icon">' +
                        'üë§' +
                        '<span class="status-dot ' + statusDotClass + '" style="position: absolute; bottom: 2px; right: 2px;"></span>' +
                    '</div>' +
                    '<div class="operator-info">' +
                        '<div class="operator-name" title="' + operator.name + '">' + operator.name + '</div>' +
                        '<div class="operator-meta">' +
                            '<span class="status-dot ' + statusDotClass + '"></span>' +
                            statusText +
                        '</div>' +
                    '</div>' +
                    '<div class="ticket-count">' +
                        '<i class="pe-7s-note2" aria-hidden="true"></i>' +
                        operator.ticketsCount +
                    '</div>';

                // Click en operador para abrir su tab
                item.addEventListener('click', function() {
                    openOperatorTab(operator.id, operator.name);
                });

                list.appendChild(item);
            });
        }

        // Funci√≥n para abrir tab de operador
        function openOperatorTab(operatorId, operatorName) {
            // Si ya est√° abierto, solo activarlo
            if (openOperatorTabs.includes(operatorId)) {
                activeOperatorTab = operatorId;
                updateTicketTabs();
                renderTickets();
                return;
            }

            // Agregar a tabs abiertos
            openOperatorTabs.push(operatorId);
            activeOperatorTab = operatorId;

            // Renderizar tabs y tickets
            updateTicketTabs();
            renderTickets();
        }

        // Funci√≥n para cerrar tab de operador
        function closeOperatorTab(operatorId) {
            openOperatorTabs = openOperatorTabs.filter(id => id !== operatorId);

            // Si cerramos el tab activo, volver a "Todos"
            if (activeOperatorTab === operatorId) {
                activeOperatorTab = null;
                ticketFilter = 'all';
            }

            updateTicketTabs();
            renderTickets();
        }

        // Funci√≥n para actualizar los tabs de tickets
        function updateTicketTabs() {
            const container = document.getElementById('ticketTabsContainer');
            if (!container) return;

            // Mantener los tabs fijos (Todos, Reasignados, No Reasignados)
            const fixedTabs = Array.from(container.querySelectorAll('[data-filter]'));

            // Limpiar tabs de operadores
            container.querySelectorAll('[data-operator]:not([data-operator=""])').forEach(tab => tab.remove());

            // Agregar tabs de operadores abiertos
            openOperatorTabs.forEach(function(operatorId) {
                const operator = operatorsData.find(op => op.id === operatorId);
                if (!operator) return;

                const tab = document.createElement('button');
                tab.className = 'ticket-filter-tab';
                tab.setAttribute('data-operator', operatorId);
                tab.setAttribute('data-filter', 'operator');

                if (activeOperatorTab === operatorId) {
                    tab.classList.add('active');
                    tab.style.color = '#FFFFFF';
                    tab.style.borderBottomColor = '#f67200';
                } else {
                    tab.style.color = '#a6adbb';
                    tab.style.borderBottomColor = 'transparent';
                }

                tab.style.background = 'none';
                tab.style.border = 'none';
                tab.style.fontSize = '1.2rem';
                tab.style.padding = '8px 16px';
                tab.style.paddingRight = '8px';
                tab.style.cursor = 'pointer';
                tab.style.borderBottom = '3px solid';
                tab.style.transition = 'all 0.3s';
                tab.style.display = 'flex';
                tab.style.alignItems = 'center';
                tab.style.gap = '8px';

                const ticketCount = operator.tickets.filter(t => t.status !== 'cerrado').length;

                tab.innerHTML =
                    '<span>üë§ ' + operator.name + '</span>' +
                    '<small><span class="badge">' + ticketCount + '</span></small>' +
                    '<button onclick="event.stopPropagation(); window.supervisorDashboard.closeOperatorTab(\'' + operatorId + '\')" style="background: none; border: none; color: #ef4444; cursor: pointer; padding: 0 4px; margin-left: 4px; font-size: 1.1.2rem;">√ó</button>';

                tab.addEventListener('click', function() {
                    activeOperatorTab = operatorId;
                    ticketFilter = 'all'; // Reset filter when switching to operator tab
                    updateTicketTabs();
                    renderTickets();
                });

                container.appendChild(tab);
            });

            // Actualizar estado de tabs fijos
            fixedTabs.forEach(function(tab) {
                if (activeOperatorTab === null && tab.getAttribute('data-filter') === ticketFilter) {
                    tab.classList.add('active');
                    tab.style.color = '#FFFFFF';
                    tab.style.borderBottomColor = '#f67200';
                } else {
                    tab.classList.remove('active');
                    tab.style.color = '#a6adbb';
                    tab.style.borderBottomColor = 'transparent';
                }
            });
        }

        // Funci√≥n para renderizar todos los tickets
        function renderTickets() {
            const container = document.getElementById('ticketsContainer');
            if (!container) return;

            // Recopilar tickets seg√∫n el tab activo
            let allTickets = [];

            if (activeOperatorTab) {
                // Mostrar solo tickets del operador seleccionado
                const operator = operatorsData.find(op => op.id === activeOperatorTab);
                if (operator) {
                    operator.tickets.forEach(function(ticket) {
                        allTickets.push({
                            ...ticket,
                            operatorId: operator.id,
                            operatorName: operator.name,
                            isReassigned: reassignmentHistory.some(function(h) {
                                return h.ticketId === ticket.id;
                            })
                        });
                    });
                }
            } else {
                // Mostrar todos los tickets
                operatorsData.forEach(function(operator) {
                    operator.tickets.forEach(function(ticket) {
                        allTickets.push({
                            ...ticket,
                            operatorId: operator.id,
                            operatorName: operator.name,
                            isReassigned: reassignmentHistory.some(function(h) {
                                return h.ticketId === ticket.id;
                            })
                        });
                    });
                });
            }

            // Filtrar tickets cerrados
            allTickets = allTickets.filter(function(ticket) {
                return ticket.status !== 'cerrado';
            });

            // Aplicar filtro de reasignaci√≥n
            if (ticketFilter === 'reassigned') {
                allTickets = allTickets.filter(function(ticket) {
                    return ticket.isReassigned;
                });
            } else if (ticketFilter === 'not-reassigned') {
                allTickets = allTickets.filter(function(ticket) {
                    return !ticket.isReassigned;
                });
            }

            // Aplicar b√∫squeda
            if (ticketSearchTerm.trim() !== '') {
                const searchLower = ticketSearchTerm.toLowerCase();
                allTickets = allTickets.filter(function(ticket) {
                    return ticket.id.toLowerCase().includes(searchLower) ||
                           ticket.name.toLowerCase().includes(searchLower) ||
                           (ticket.assignedAgent && ticket.assignedAgent.toLowerCase().includes(searchLower)) ||
                           ticket.operatorName.toLowerCase().includes(searchLower);
                });
            }

            // Actualizar contadores
            updateTicketCounts(allTickets);

            if (allTickets.length === 0) {
                container.innerHTML =
                    '<div class="empty-state">' +
                        '<i class="pe-7s-note2" aria-hidden="true"></i>' +
                        '<p>No hay tickets que mostrar</p>' +
                    '</div>';
                return;
            }

            const ticketsList = document.createElement('div');
            ticketsList.className = 'tickets-list';

            allTickets.forEach(function(ticket) {
                const ticketCard = document.createElement('div');
                ticketCard.className = 'ticket-card';

                const priorityClass = 'priority-' + ticket.priority;
                const statusClass = ticket.status;
                const elapsedTime = getElapsedTime(ticket.startTime);

                const statusText = {
                    'abierto': 'Abierto',
                    'asignado': 'Asignado',
                    'en-atencion': 'En Atenci√≥n'
                }[ticket.status] || ticket.status;

                // Verificar si el ticket est√° seleccionado
                const isSelected = selectedTickets.includes(ticket.id);
                if (isSelected) {
                    ticketCard.classList.add('selected');
                }

                // Badge de reasignado
                const reassignedBadge = ticket.isReassigned
                    ? '<span style="background: #8b5cf6; color: white; font-size: 0.65rem; padding: 2px 6px; border-radius: 8px; margin-left: 6px;">REASIGNADO</span>'
                    : '';

                ticketCard.innerHTML =
                    '<div class="ticket-header">' +
                        '<div style="display: flex; align-items: center; gap: 10px;">' +
                            '<input type="checkbox" class="ticket-checkbox" data-ticket-id="' + ticket.id + '" ' + (isSelected ? 'checked' : '') + '>' +
                            '<div class="ticket-id">' +
                                '<span class="priority-circle ' + priorityClass + '"></span>' +
                                ticket.id + reassignedBadge +
                            '</div>' +
                        '</div>' +
                        '<span class="ticket-status ' + statusClass + '">' + statusText + '</span>' +
                    '</div>' +
                    '<div class="ticket-body">' +
                        '<div class="ticket-info">' +
                            '<div class="info-row">' +
                                '<i class="pe-7s-note" aria-hidden="true"></i>' +
                                '<strong>' + ticket.name + '</strong>' +
                            '</div>' +
                            '<div class="info-row">' +
                                '<i class="pe-7s-id" aria-hidden="true"></i>' +
                                'Operador: <strong>' + ticket.operatorName + '</strong>' +
                            '</div>' +
                            '<div class="info-row">' +
                                '<i class="pe-7s-user" aria-hidden="true"></i>' +
                                'Agente: ' + (ticket.assignedAgent || '<em>Sin asignar</em>') +
                            '</div>' +
                            '<div class="info-row">' +
                                '<i class="pe-7s-clock" aria-hidden="true"></i>' +
                                'Inicio: ' + ticket.startTime.toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit' }) +
                            '</div>' +
                        '</div>' +
                        '<div class="ticket-time">' +
                            '<div class="time-label"><small>TRANSCURRIDO</small></div>' +
                            '<div class="time-value">' + elapsedTime + '</div>' +
                        '</div>' +
                    '</div>';

                ticketsList.appendChild(ticketCard);
            });

            container.innerHTML = '';
            container.appendChild(ticketsList);

            // Event delegation para checkboxes
            ticketsList.addEventListener('change', function(e) {
                if (e.target.classList.contains('ticket-checkbox')) {
                    const ticketId = e.target.getAttribute('data-ticket-id');
                    handleTicketSelection(ticketId, e.target.checked);
                }
            });
        }

        // Funci√≥n para actualizar contadores de tickets
        function updateTicketCounts(allTickets) {
            // Todos los tickets activos
            const totalTickets = allTickets.length;

            // Tickets reasignados
            const reassignedTickets = allTickets.filter(function(ticket) {
                return ticket.isReassigned;
            }).length;

            // Tickets no reasignados
            const notReassignedTickets = totalTickets - reassignedTickets;

            // Actualizar badges
            const allCount = document.getElementById('allTicketsCount');
            const reassignedCount = document.getElementById('reassignedTicketsCount');
            const notReassignedCount = document.getElementById('notReassignedTicketsCount');

            if (allCount) allCount.textContent = totalTickets;
            if (reassignedCount) reassignedCount.textContent = reassignedTickets;
            if (notReassignedCount) notReassignedCount.textContent = notReassignedTickets;
        }

        // Funci√≥n para manejar selecci√≥n/deselecci√≥n de tickets
        function handleTicketSelection(ticketId, isChecked) {
            if (isChecked) {
                // Agregar a seleccionados si no est√°
                if (!selectedTickets.includes(ticketId)) {
                    selectedTickets.push(ticketId);
                }
            } else {
                // Remover de seleccionados
                selectedTickets = selectedTickets.filter(function(id) {
                    return id !== ticketId;
                });
            }

            // Actualizar UI
            updateReassignButton();
            renderTickets();
        }

        // Funci√≥n para actualizar bot√≥n de reasignaci√≥n
        function updateReassignButton() {
            const btn = document.getElementById('reassignSelectedBtn');
            const countSpan = document.getElementById('selectedTicketsCount');

            if (!btn || !countSpan) return;

            if (selectedTickets.length > 0) {
                btn.style.display = 'block';
                countSpan.textContent = selectedTickets.length;
            } else {
                btn.style.display = 'none';
            }
        }

        // Funci√≥n para abrir modal de reasignaci√≥n
        function openReassignModal() {
            if (selectedTickets.length === 0) return;

            // Resetear selecci√≥n de operador
            selectedOperatorForReassign = null;

            const modalBody = document.getElementById('reassignModalBody');
            const subtitle = document.getElementById('reassignModalSubtitle');
            const confirmBtn = document.getElementById('confirmReassignBtn');

            // Actualizar subt√≠tulo
            subtitle.textContent = 'Seleccione el operador destino para ' + selectedTickets.length + ' ticket(s)';

            // Obtener todos los operadores
            const availableOperators = operatorsData;

            let html = '';

            // Mostrar tickets que se van a reasignar
            html += '<div class="row"><div class="col-lg-12">';
            html += '<div class="panel panel-filled panel-c-accent" style="border-radius: 15px; margin-bottom: 20px;">';
            html += '<div class="panel-heading"><h5>TICKETS A REASIGNAR</h5></div>';
            html += '<div class="panel-body" style="max-height: 200px; overflow-y: auto;">';

            selectedTickets.forEach(function(ticketId) {
                // Buscar el ticket en todos los operadores
                let foundTicket = null;
                let foundOperator = null;
                operatorsData.forEach(function(op) {
                    const ticket = op.tickets.find(t => t.id === ticketId);
                    if (ticket) {
                        foundTicket = ticket;
                        foundOperator = op;
                    }
                });

                if (foundTicket) {
                    html += '<div style="padding: 8px 12px; border-bottom: 1px solid #2a2a2a; display: flex; justify-content: space-between;">';
                    html += '<div><span style="font-weight: 600;">' + foundTicket.id + '</span> <small style="color: #8b5cf6;">(' + foundOperator.name + ')</small></div>';
                    html += '<span style="color: #a6adbb;">' + foundTicket.name + '</span>';
                    html += '</div>';
                }
            });

            html += '</div></div></div></div>';

            // Mostrar dropdown de operadores destino
            html += '<div class="row"><div class="col-lg-12">';
            html += '<div class="panel panel-filled panel-c-accent" style="border-radius: 15px;">';
            html += '<div class="panel-heading"><h5>SELECCIONAR OPERADOR DESTINO</h5></div>';
            html += '<div class="panel-body">';
            html += '<div class="form-group">';
            html += '<label>Operador *</label>';
            html += '<select id="operatorDestinationSelect" class="form-control rounded-input">';
            html += '<option value="">Seleccione un operador</option>';

            availableOperators.forEach(function(operator) {
                const activeTicketsCount = operator.tickets.filter(t => t.status !== 'cerrado').length;
                html += '<option value="' + operator.id + '">' + operator.name + ' (' + activeTicketsCount + ' tickets activos)</option>';
            });

            html += '</select>';
            html += '</div>';
            html += '</div></div></div></div>';

            modalBody.innerHTML = html;

            // Deshabilitar bot√≥n de confirmar
            confirmBtn.disabled = true;

            // Event listener para el select
            const selectElement = document.getElementById('operatorDestinationSelect');
            if (selectElement) {
                selectElement.addEventListener('change', function() {
                    const selectedValue = this.value;
                    if (selectedValue) {
                        selectedOperatorForReassign = selectedValue;
                        confirmBtn.disabled = false;
                    } else {
                        selectedOperatorForReassign = null;
                        confirmBtn.disabled = true;
                    }
                });
            }

            // Abrir modal con Bootstrap
            if (window.$ && typeof window.$('#reassignModal').modal === 'function') {
                window.$('#reassignModal').modal('show');
            }
        }

        // Funci√≥n para confirmar reasignaci√≥n
        function confirmReassignment() {
            if (!selectedOperatorForReassign || selectedTickets.length === 0) return;

            const toOperator = operatorsData.find(op => op.id === selectedOperatorForReassign);
            if (!toOperator) return;

            let movedCount = 0;

            // Reasignar cada ticket seleccionado
            selectedTickets.forEach(function(ticketId) {
                // Buscar el ticket en todos los operadores
                operatorsData.forEach(function(fromOperator) {
                    const ticketIndex = fromOperator.tickets.findIndex(t => t.id === ticketId);
                    if (ticketIndex !== -1) {
                        // Remover del operador origen
                        const ticket = fromOperator.tickets.splice(ticketIndex, 1)[0];

                        // Agregar al operador destino
                        toOperator.tickets.push(ticket);

                        // Agregar al historial de reasignaciones
                        reassignmentHistory.push({
                            ticketId: ticket.id,
                            ticketName: ticket.name,
                            priority: ticket.priority,
                            status: ticket.status,
                            fromOperator: fromOperator.name,
                            toOperator: toOperator.name,
                            reassignedAt: new Date(),
                            assignedAgent: ticket.assignedAgent
                        });

                        // Actualizar contador del operador origen
                        fromOperator.ticketsCount = fromOperator.tickets.filter(t => t.status !== 'cerrado').length;

                        movedCount++;
                    }
                });
            });

            // Actualizar contador del operador destino
            toOperator.ticketsCount = toOperator.tickets.filter(t => t.status !== 'cerrado').length;

            // Limpiar selecci√≥n
            selectedTickets = [];
            selectedOperatorForReassign = null;

            // Cerrar modal con Bootstrap
            if (window.$ && typeof window.$('#reassignModal').modal === 'function') {
                window.$('#reassignModal').modal('hide');
            }

            // Actualizar vistas
            renderOperators();
            renderTickets();
            updateReassignButton();
            updateReassignedCount();

            // Mostrar notificaci√≥n
            console.log(movedCount + ' ticket(s) reasignado(s) a ' + toOperator.name);
        }

        // Funci√≥n para actualizar contador de tickets reasignados
        function updateReassignedCount() {
            // Esta funci√≥n actualiza el badge de tickets reasignados en los filtros
            // Se llama autom√°ticamente cuando se actualiza renderTickets()
        }

        // Funci√≥n para manejar b√∫squeda de operadores
        function handleOperatorSearch(event) {
            operatorSearchTerm = event.target.value;
            renderOperators();
        }

        // Funci√≥n para manejar b√∫squeda de tickets
        function handleTicketSearch(event) {
            ticketSearchTerm = event.target.value;
            renderTickets();
        }

        // Funci√≥n para cambiar filtro de tickets
        function switchTicketFilter(filter) {
            ticketFilter = filter;

            // Actualizar estilos de tabs
            const tabs = document.querySelectorAll('.ticket-filter-tab');
            tabs.forEach(function(tab) {
                const tabFilter = tab.getAttribute('data-filter');
                if (tabFilter === filter) {
                    tab.style.color = '#FFFFFF';
                    tab.style.borderBottomColor = '#f67200';
                    tab.classList.add('active');
                } else {
                    tab.style.color = '#a6adbb';
                    tab.style.borderBottomColor = 'transparent';
                    tab.classList.remove('active');
                }
            });

            // Limpiar selecci√≥n de tickets al cambiar filtro
            selectedTickets = [];
            updateReassignButton();

            // Renderizar tickets con nuevo filtro
            renderTickets();
        }

        // Inicializar dashboard
        function init() {
            renderOperators();
            renderTickets(); // Renderizar tickets al inicio
            updateReassignedCount();

            // Event listener para b√∫squeda de operadores
            const searchInput = document.getElementById('operatorSearch');
            if (searchInput) {
                searchInput.addEventListener('input', handleOperatorSearch);
            }

            // Event listener para b√∫squeda de tickets
            const ticketSearchInput = document.getElementById('ticketSearch');
            if (ticketSearchInput) {
                ticketSearchInput.addEventListener('input', handleTicketSearch);
            }

            // Event listeners para filtros de tickets
            const filterTabs = document.querySelectorAll('.ticket-filter-tab');
            filterTabs.forEach(function(tab) {
                tab.addEventListener('click', function() {
                    const filter = this.getAttribute('data-filter');
                    switchTicketFilter(filter);
                });
            });

            // Event listeners para filtros de operadores
            const operatorFilterTabs = document.querySelectorAll('.operator-filter-tab');
            operatorFilterTabs.forEach(function(tab) {
                tab.addEventListener('click', function() {
                    const filter = this.getAttribute('data-filter');
                    operatorFilter = filter;

                    // Actualizar estilos de tabs
                    operatorFilterTabs.forEach(function(t) {
                        if (t.getAttribute('data-filter') === filter) {
                            t.classList.add('active');
                            t.style.color = '#FFFFFF';
                            t.style.borderBottomColor = '#f67200';
                        } else {
                            t.classList.remove('active');
                            t.style.color = '#a6adbb';
                            t.style.borderBottomColor = 'transparent';
                        }
                    });

                    renderOperators();
                });
            });

            // Actualizar tiempos cada minuto
            setInterval(function() {
                renderTickets();
            }, 60000); // 60 segundos
        }

        // Ejecutar al cargar
        init();

        // Exponer funciones globalmente si es necesario
        window.supervisorDashboard = {
            refresh: function() {
                renderOperators();
                if (selectedOperatorId) {
                    renderTickets(selectedOperatorId);
                }
            },
            updateData: function(newData) {
                operatorsData = newData;
                renderOperators();
                if (selectedOperatorId) {
                    renderTickets(selectedOperatorId);
                }
            },
            openReassignModal: openReassignModal,
            confirmReassignment: confirmReassignment,
            closeOperatorTab: closeOperatorTab
        };
    })();
    </script>
</div>
